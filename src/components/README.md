





*适合中小企业产品或项目，安全，高可用，经济，可扩展，可维护
* [框架说明](./doc/instructions/instructions.md)
* [演示](http://193.112.136.240:8081)


# 框架目标:聚集在实现业务逻辑上
### 为解决问题而存在，不是哪个先进，哪个过时
* 排除框架不完善、编码不规范和技术不过关等因素带来的困扰
* 范围:适合初创公司或中小企业使用
* 权衡利弊，综合考虑各种重要因素:用户体验、性能(可靠性)、代码键壮性、安全性、功能需求和可扩展性
> * 整体服务vs微服务，用微服务，想为每一个服务使用最好的工具(需求不一样)
> * 全栈vs非全栈
> * 代码实现vs业务变通，如下单立马产生送优惠券vs用户自己领优惠券，Excel导入vs用Excel转文本再导入
* 减少宕机和故障
* 支持纵向扩展和横向扩展, 有些框架从不考虑扩展性
* 系统安全，有些框架几乎没有考虑安全问题
* 模块化，对技术不了解，不会使用模块化，不可同时支持集中和独立部置
* 高性能，对技术不了解，造成乱用
* 追求0配置，0单点故障

# 框架问题:技术债务越来越多
* 框架就像一棵树，问题是树枝，前期不处理好，分枝越来越多。因为解决一个问题又会产生几个问题。
* 每个树枝就像一个债务，有些树枝就像高利贷。

# 框架存在的常见问题
1. 稳定性差，经常宕机或经常有严重故障
> * 登录认证，权限管理
> 1. 依赖性强，易产生单点故障(如依赖于redis或依赖于网关)
> 2. 性能差，一次请求大量访问数据库(纵向和横向扩展几乎为0)

2. 系统架构不合理，没有分布式和模块化分层的思想，模块和模块间的代码耦合很严重，改动其一发动全身

3. 迭代慢，系统架构深度复杂，稳定性差
> * 前期开发速度快，后期开发速度慢

4. 缺少解决问题的能力
> 1. 不权衡利弊，不结合业务普通。否定整体服务各微服务，或否定全栈或全部全栈。或一上来就一个大框架(google或阿里)
> 2. 一个if语句写到底(考勤方案，价格方案)
> 3. 不了解对象，在非安全线程对象上加上field
> 4. 接口，物流请求耗时(3秒)
> 5. 如何调试接口，TDD(测试驱动开发(Test-Driven Development))

# 模块化
三个模块(解耦;能一步做完的工作，不作两步以上)
1. 共用模块，使用原则：规范大于配置，默认大于规范
> * 安全性、性能、可靠性，可维护性
2. 监控模块，缺少监控，系统性能无法评估，问题不能快速找到原因；缺少警告
> 

# 安全性
* 高效防止越权漏洞
	1.使用网关统一处理请求，通过本地缓存位图数据控制URI权限，然后把操作权限写入请求header来控制操作按键
	2.使用简单代码实现预防参数攻击,如代码update(bean, new LimitRecord("mer_id", merId))
* 高效防止SQL注入漏洞，并有警告
* 高效防止XSS跨站漏洞
* 高效防止CSRF跨站请求伪造(支持分布式令牌)
* 高效防止登录测试
* 防止HTTP慢连接拒绝服务攻击漏洞和Cookie修改攻

# 警告
* 未关闭连接 
* for update不加事务 
* sql没有加上where 
* 事务个数大于1
* 多个操作SQL没有事务
* sql注入风险
* POST请求了支持GET的接口

# 客户体验
* 同步异步加载都有loading页
* 点击页面后延迟n毫秒再判断是否要出现loading页,并防止重复提交
* 代码更新需要按Ctrl+F5来强制刷新

# 常见反例
* 半maven或maven架构不合理，打包工作量太大
* 需要Link Source，Link Source缺点:1.需要知道Link Source 2.不知是否已经提交 3.查找文件会多出一个
* 进一个页面进行两次请求，一次显示页面，一次异步请求
* 分页数据为0时，进行两次SQL查询
* 大量的拼装SQL
* 判断某字段是否已经存，还专门写SQL或分开写有BUG的SQL
* 出现过多跟业务无法的代码，
> * 如request,response,try catch,debug,
> * log.debug(输入参数/输出参数),log.debug(sql) 
> * toJson之类，字符串转Json
> * 大量配置请求@RequestMapping("/user/getUser")，GET和POST不分
> * 返回实现不封闭，每次都new
* 配置文件混乱
> * 不同环境不同配置，例如静态文件存CDN
> * 敏感配置放到配置文件，多机需要改多个地方，不支持按环境分，不容易打包
> * 有新的配置加入怎么办
* 打包
> * 用maven打profiles包，造成每个环境代码不一样
* 异常处理问题
> * 所有异常都打印
> * 代码自己中自己加了多余try...catch
* js脚本引用错乱(没有继承引用)，修改css或js，还要Ctrl+F5
* 用代码生成器生成一堆Service、ServiceImpl、Dao、DaoImpl、xml等文件，谁是真正的接口
* 页面没有模板化，有太多不需要关注的代码
* 用户体验差，连接不上不出现loading页
* 没有统一错误处理机制
* 缺少安全性
> * SQL注入等
* 系统不能方便纵向扩展和横向扩展
* session和权限访问数据库或redis
* 增删改查之前调用sqlId出SQL
* 关键模块一个if写到底
> * 不了解关系数据库或no sql数据库，一个if写到底的方式，不会利用概念模型设计，索引，not null，热点等特性
* 哪些该做，哪些不该做
> * 如后台应用菜单:支持iframe又支持div，造成太多奇怪代码
> * 使用异步请求造成页面跳动，高度难判断
* 功能代码影响范围广，在写独立功能模块时还需要修改共用代码，修改共用配置，代码耦合度高
* 不支持并发
> * 在Controller里使用Field，造成多个请求使用同个对象，插入或修改时不支持唯一值
* 缺少系统思考，架构师不懂写代码，数据库设定不懂模型设计，Java程序员不懂写js
* 没有工程构建方法或是半maven形式
* 缺少对公共类的管理，通过引入jar，导致难找问题，简单调用变成在调用黑盒子的接口，变更没通知
* 难以定位问题，通过url不方便找到类
* 缺少监控
> * 系统性能无法评估，问题不能快速找到原因
> * 缺少警告，如:update或delete不加where不会警告
> * 不能实时了解开发人员代码质量
* 修改代码需要重启服务
* 用注释来处理魔法数字，意义变了，注释还没有改过来
* 不了解用户需求，按程序员的方式设计，如单选人员或多选人员或商品，一上来就是选择框
* context-path写死了


#### Less is more
* 制定了一套符合公司现状的编码准则，限定
















